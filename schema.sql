-- Script de Criação de Tabelas (Simulando Oracle/H2)

-- Tabela CLIENTE
CREATE TABLE CLIENTE (
    ID BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NOME VARCHAR(255) NOT NULL,
    TIPO_PESSOA VARCHAR(2) NOT NULL CHECK (TIPO_PESSOA IN ('PF', 'PJ')),
    CPF VARCHAR(14) UNIQUE,
    CNPJ VARCHAR(18) UNIQUE,
    TELEFONE VARCHAR(20),
    DATA_CADASTRO TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL
);

-- Tabela ENDERECO
CREATE TABLE ENDERECO (
    ID BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    CLIENTE_ID BIGINT NOT NULL,
    LOGRADOURO VARCHAR(255) NOT NULL,
    NUMERO VARCHAR(10),
    COMPLEMENTO VARCHAR(100),
    BAIRRO VARCHAR(100) NOT NULL,
    CIDADE VARCHAR(100) NOT NULL,
    UF VARCHAR(2) NOT NULL,
    CEP VARCHAR(9) NOT NULL,
    FOREIGN KEY (CLIENTE_ID) REFERENCES CLIENTE(ID)
);

-- Tabela CONTA
CREATE TABLE CONTA (
    ID BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    CLIENTE_ID BIGINT NOT NULL,
    NUMERO_CONTA VARCHAR(50) NOT NULL,
    AGENCIA VARCHAR(10) NOT NULL,
    INSTITUICAO_FINANCEIRA VARCHAR(100) NOT NULL,
    SALDO_INICIAL DECIMAL(19, 2) NOT NULL,
    DATA_ABERTURA TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,
    EXCLUSAO_LOGICA BOOLEAN DEFAULT FALSE NOT NULL,
    FOREIGN KEY (CLIENTE_ID) REFERENCES CLIENTE(ID),
    UNIQUE (CLIENTE_ID, NUMERO_CONTA, AGENCIA)
);

-- Tabela MOVIMENTACAO
CREATE TABLE MOVIMENTACAO (
    ID BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    CONTA_ID BIGINT NOT NULL,
    DATA_MOVIMENTACAO TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,
    TIPO VARCHAR(10) NOT NULL CHECK (TIPO IN ('CREDITO', 'DEBITO')),
    VALOR DECIMAL(19, 2) NOT NULL,
    DESCRICAO VARCHAR(255),
    FOREIGN KEY (CONTA_ID) REFERENCES CONTA(ID)
);

-- Tabela RECEITA_XPTO
CREATE TABLE RECEITA_XPTO (
    ID BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    CLIENTE_ID BIGINT NOT NULL,
    PERIODO_INICIO DATE NOT NULL,
    PERIODO_FIM DATE NOT NULL,
    QTD_MOVIMENTACOES INT NOT NULL,
    VALOR_COBRADO DECIMAL(19, 2) NOT NULL,
    FOREIGN KEY (CLIENTE_ID) REFERENCES CLIENTE(ID)
);
